import{o as e,c as t,r,E as n,a as s,d as o,b as i,e as a,f as d,g as c,i as l,h as u,j as f,k as p,l as g,s as m,m as y,n as h}from"./vendor-25062bde.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const w=(e,t)=>{const r=e.__vccOpts||e;for(const[n,s]of t)r[n]=s;return r},v=w({},[["render",function(n,s){const o=r("router-view");return e(),t(o)}]]);s.defaults.baseURL="/api-pro",s.defaults.timeout=1e4,s.defaults.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8";const I=s.create({responseType:"json",transformResponse:[function(e){try{e=JSON.parse(e)}catch(t){}return e}]});I.interceptors.request.use((e=>(e.headers={...e.headers},e)),(e=>Promise.reject(e)));const F={404:new class{handle(e){const{reason:t,message:r}=e.data;t&&n.error(t),r&&n.error(r)}},112:new class{handle(e){n.error("Token 过期")}},212:new class{handle(e){n.error("无权限")}}};I.interceptors.response.use((e=>{const{code:t}=e.data;if(![0,"0",200,"200"].includes(t)){const r=F[t];null==r||r.handle(e)}return e}),(e=>{var t;return t=e.message,n.error(t),Promise.reject(e)}));const L=e=>new Promise(((t,r)=>{I.request(e).then((e=>{t(e.data)})).catch((e=>{}))})),O=(e,t={},r)=>L({url:e,params:t,...r,method:"GET"}),S=(e,t={},r)=>L({url:e,data:t,...r,method:"POST"});function P(e){return async function(...t){try{return await e(...t)}catch(r){throw e.name,r}}}function R(e){for(const t of Object.getOwnPropertyNames(e.prototype)){const r=Object.getOwnPropertyDescriptor(e.prototype,t);r&&"function"==typeof r.value&&(e.prototype[t]=P(r.value))}return e}Object.defineProperty,Object.getOwnPropertyDescriptor;let C=class{async getUserFriends(){return await O("/user/friends")}async getUserFriendsPending(){return await O("/user/friends/pending")}async getUserFriendsBlocked(){return await O("/user/friends/blocked")}async getUserInfo(e){return await S("/relationships/getFriendByUserId2",{userId:e})}async getUserInfoByFriendId(e){return await O("/user/getFriendInfo",{friendId:e})}};C=((e,t,r,n)=>{for(var s,o=t,i=e.length-1;i>=0;i--)(s=e[i])&&(o=s(o)||o);return o})([R],C);const b=new C,j=o("friends",{state:()=>({friends:[],pendingFriends:[],pendingFriendsList:[],pendingFriendsRequestList:[],onlineFriendsList:[],blockedFriends:[],friendInfo:{}}),getters:{handlePendingFriendsList:e=>(e.pendingFriendsList=e.pendingFriends.filter((e=>!e.isInitiative)).concat(e.pendingFriends.filter((e=>e.isInitiative))),e.pendingFriendsList),handlePendingFriendsRequestList:e=>(e.pendingFriendsRequestList=e.pendingFriends.filter((e=>!e.isInitiative)),e.pendingFriendsRequestList),handleOnlineFriendsList:e=>(e.onlineFriendsList=e.friends.filter((e=>"offline"!==e.status)),e.onlineFriendsList)},actions:{async getFriends(){const{data:e,code:t}=await b.getUserFriends();0===t&&(this.friends=e.friends||[])},async getPendingFriends(){const{data:e,code:t}=await b.getUserFriendsPending();0===t&&(this.pendingFriends=e.friends||[])},async getBlockedFriends(){const{data:e,code:t}=await b.getUserFriendsBlocked();0===t&&(this.blockedFriends=e.friends||[])},async getFriendInfo(e){const{data:t,code:r}=await b.getUserInfoByFriendId(e);200===r&&(this.friendInfo=t.friendInfo)}}});o("privateLetter",{state:()=>({privateLetterCount:[]}),getters:{getPrivateLetterCount:e=>(e.privateLetterCount=j().handlePendingFriendsRequestList,e.privateLetterCount)},actions:{}});Object.defineProperty,Object.getOwnPropertyDescriptor;let U=class{async getLogin(e){const{username:t,password:r,userEmail:n,smsCode:s}=e;return await S("/auth/login",{username:t,password:r,userEmail:n,smsCode:s})}async getSmsCode(e){return await S("/auth/verify-code",{email:e})}async getLogout(){return await S("/auth/logout")}async getRegister(e){const{username:t,password:r,email:n,smsCode:s,role:o}=e;return await S("/auth/register",{username:t,password:r,email:n,smsCode:s,role:o})}};U=((e,t,r,n)=>{for(var s,o=t,i=e.length-1;i>=0;i--)(s=e[i])&&(o=s(o)||o);return o})([R],U);const E=new U,k={},D=function(e,t,r){if(!t||0===t.length)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map((e=>{if((e="/CollectX-Display-System/"+e)in k)return;k[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(r)for(let r=n.length-1;r>=0;r--){const s=n[r];if(s.href===e&&(!t||"stylesheet"===s.rel))return}else if(document.querySelector(`link[href="${e}"]${s}`))return;const o=document.createElement("link");return o.rel=t?"stylesheet":"modulepreload",t||(o.as="script",o.crossOrigin=""),o.href=e,document.head.appendChild(o),t?new Promise(((t,r)=>{o.addEventListener("load",t),o.addEventListener("error",(()=>r(new Error(`Unable to preload CSS for ${e}`))))})):void 0}))).then((()=>e()))},_=[{path:"/",name:"Home",component:()=>D((()=>import("./index-2aebbbbb.js")),["assets/index-2aebbbbb.js","assets/vendor-25062bde.js","assets/vendor-16595379.css"])}],N=i({history:a("/CollectX-Display-System"),routes:_,scrollBehavior:()=>({left:0,top:0})}),T={getItem(e){const t=localStorage.getItem(e);if(t){const{value:r,expires:n}=JSON.parse(t);return!n||n>=Date.now()?r:(this.removeItem(e),null)}return null},setItem(e,t,r=86400){this.removeItem(e);const n=r&&Date.now()+1e3*r;localStorage.setItem(e,JSON.stringify({value:t,expires:n}))},removeItem(e){localStorage.removeItem(e)},clear(){localStorage.clear()}};Object.defineProperty,Object.getOwnPropertyDescriptor;let q=class{async getCurrentUser(){return await O("/userFriends/getCurrentUser")}async getCommonServerCount(e){return await O("/userFriends/getCommonServerCount",{friendId:e})}};q=((e,t,r,n)=>{for(var s,o=t,i=e.length-1;i>=0;i--)(s=e[i])&&(o=s(o)||o);return o})([R],q);const x=new q;o("user",{state:()=>({user:{},userInfo:{}}),getters:{getUserId(){return this.user.id},getUserAvatar(){return this.userInfo.avatar}},actions:{async userLogin(e){const{code:t,reason:r}=await E.getLogin(e);200===t?(await N.push("main"),T.setItem("userId",this.user.id)):n.error(r)},async getUserInfo(){const{code:e,reason:t,data:r}=await x.getCurrentUser();200===e?this.userInfo=r:n.error(t)}}});const B=d(),X=l({apiKey:"AIzaSyCeK69F3TvL89H2qGMYXjLLoSg-9cjcHIc",authDomain:"collectx-display-system.firebaseapp.com",projectId:"collectx-display-system",storageBucket:"collectx-display-system.appspot.com",messagingSenderId:"577701716312",appId:"1:577701716312:web:09e5e010e2fdee3b10c52d",measurementId:"G-XTRQ1DL8SH"});u(X),f(X);const W=p(v),A=d();for(const[H,G]of Object.entries(g))W.component(H,G);!function(e={}){const{immediate:t=!0,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:o,onRegisterError:i}=e,a=c(!1),d=c(!1);!function(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:o,onRegisterError:i}=e;let a,d;d=async function(){if("serviceWorker"in navigator){const{Workbox:e}=await D((()=>import("./vendor-25062bde.js").then((e=>e.w))),["assets/vendor-25062bde.js","assets/vendor-16595379.css"]);a=new e("/CollectX-Display-System/sw.js",{scope:"/CollectX-Display-System/",type:"classic"}),a.addEventListener("activated",(e=>{(e.isUpdate||e.isExternal)&&window.location.reload()})),a.addEventListener("installed",(e=>{e.isUpdate||null==n||n()})),a.register({immediate:t}).then((e=>{o?o("/CollectX-Display-System/sw.js",e):null==s||s(e)})).catch((e=>{null==i||i(e)}))}}()}({immediate:t,onNeedRefresh(){a.value=!0,null==r||r()},onOfflineReady(){d.value=!0,null==n||n()},onRegistered:s,onRegisteredSW:o,onRegisterError:i})}(),A.use(m),W.use(A),W.use(B),W.use(N),W.use(y,{locale:h}),W.mount("#app");export{w as _};
